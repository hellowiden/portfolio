{"version":3,"sources":["../../../../../../packages/ui/src/components/SearchInput/SearchInput.tsx","../../../../../../apps/dashboard/src/app/dashboard/messages/page.tsx"],"sourcesContent":["//src/app/components/SearchInput/SearchInput.tsx\n\n'use client';\n\nimport { usePathname } from 'next/navigation';\n\ninterface User {\n  name: string;\n  email: string;\n  roles: string[];\n}\n\ninterface Project {\n  name: string;\n  description?: string;\n  tags?: string[];\n}\n\ninterface Message {\n  userName: string;\n  userEmail: string;\n  message: string;\n  reason: string;\n}\n\ninterface Experience {\n  title: string;\n  location: string;\n  tags: string[];\n  type: string;\n}\n\ntype SearchData = User | Project | Message | Experience;\n\ninterface SearchInputProps<T extends SearchData> {\n  value: string;\n  onChange: (value: string) => void;\n  data: T[];\n  onFilter: (filtered: T[]) => void;\n}\n\nconst filters = {\n  '/users': (item: SearchData, q: string) => {\n    const { name, email, roles } = item as User;\n    return (\n      name?.toLowerCase().includes(q) ||\n      email?.toLowerCase().includes(q) ||\n      roles?.some((r) => r.toLowerCase().includes(q))\n    );\n  },\n  '/projects': (item: SearchData, q: string) => {\n    const { name, description, tags } = item as Project;\n    return (\n      name?.toLowerCase().includes(q) ||\n      description?.toLowerCase().includes(q) ||\n      tags?.some((t) => t.toLowerCase().includes(q))\n    );\n  },\n  '/messages': (item: SearchData, q: string) => {\n    const { userName, userEmail, message, reason } = item as Message;\n    return (\n      userName?.toLowerCase().includes(q) ||\n      userEmail?.toLowerCase().includes(q) ||\n      message?.toLowerCase().includes(q) ||\n      reason?.toLowerCase().includes(q)\n    );\n  },\n  '/experiences': (item: SearchData, q: string) => {\n    const { title, location, tags } = item as Experience;\n    return (\n      title?.toLowerCase().includes(q) ||\n      location?.toLowerCase().includes(q) ||\n      tags?.some((t) => t.toLowerCase().includes(q))\n    );\n  },\n};\n\nexport default function SearchInput<T extends SearchData>({\n  value,\n  onChange,\n  data,\n  onFilter,\n}: SearchInputProps<T>) {\n  const pathname = usePathname();\n\n  const filterData = (query: string) => {\n    const q = query.toLowerCase();\n    const filterKeys = Object.keys(filters) as Array<keyof typeof filters>;\n    const match = filterKeys.find((key) => pathname.includes(key));\n    const filterFn = match ? filters[match] : () => false;\n    onFilter(data.filter((item) => filterFn(item, q)));\n  };\n\n  return (\n    <input\n      type=\"text\"\n      placeholder=\"Search...\"\n      value={value}\n      onChange={(e) => {\n        const query = e.target.value;\n        onChange(query);\n        filterData(query);\n      }}\n      className=\"border border-primary-200 dark:border-secondary-800 p-2 rounded w-1/3 bg-primary-50 dark:bg-secondary-700 text-primary-900 dark:text-secondary-50\"\n    />\n  );\n}\n","// src/app/dashboard/messages/page.tsx\n\n'use client';\n\nimport { useEffect, useState, useCallback } from 'react';\nimport SearchInput from '@portfolio/ui/components/SearchInput/SearchInput';\nimport Button from '@portfolio/ui/components/Button/Button';\n\ninterface Message {\n  _id: string;\n  userName: string;\n  userEmail: string;\n  message: string;\n  reason: string;\n  response: string;\n  isResolved: boolean;\n  createdAt: string;\n  budget?: string;\n}\n\n// === Utility ===\n\nconst getPriorityColor = (reason: string, budget?: string) => {\n  const lowerReason = reason.toLowerCase();\n  if (lowerReason.includes('issue')) return 'bg-red-600';\n  if (lowerReason.includes('job') && budget) {\n    const budgetEnum: Record<string, string> = {\n      under_3000: 'bg-red-500',\n      '3000_4500': 'bg-orange-500',\n      '4500_6000': 'bg-yellow-500',\n      '6000_8000': 'bg-green-500',\n      '8000_plus': 'bg-blue-500',\n    };\n    return budgetEnum[budget] || 'bg-primary-300 dark:bg-secondary-600';\n  }\n  return 'bg-green-500';\n};\n\n// === Message Card Component ===\n\nfunction MessageCard({\n  msg,\n  onDelete,\n}: {\n  msg: Message;\n  onDelete: (id: string) => void;\n}) {\n  const handleDelete = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    onDelete(msg._id);\n  };\n\n  const textBlockClass = 'text-sm opacity-80 tracking-wide leading-snug';\n\n  return (\n    <section className=\"grid gap-3 p-6 w-full h-full bg-white dark:bg-secondary-800 text-primary-900 dark:text-secondary-50 border border-primary-200 dark:border-secondary-700 rounded-md cursor-pointer hover:shadow-md hover:ring-1 hover:ring-primary-300 dark:hover:ring-offset-2 hover:ring-offset-2 transition-shadow\">\n      <div\n        className={`h-2 w-full rounded ${getPriorityColor(\n          msg.reason,\n          msg.budget\n        )}`}\n      />\n\n      <div className=\"grid grid-cols-[1fr_auto] items-start gap-2\">\n        <h2 className=\"text-lg font-bold tracking-tight\">{msg.reason}</h2>\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={handleDelete}\n          className=\"p-2 text-sm\"\n        >\n          Delete\n        </Button>\n      </div>\n\n      <p className={textBlockClass}>\n        <strong>From:</strong> {msg.userName} ({msg.userEmail})\n      </p>\n\n      <p className={textBlockClass}>\n        <strong>Message:</strong> {msg.message}\n      </p>\n\n      {msg.message.startsWith('http') && (\n        <a\n          href={msg.message}\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          className=\"text-primary-700 dark:text-secondary-200 underline\"\n        >\n          View Attachment\n        </a>\n      )}\n\n      {msg.budget && (\n        <p className={textBlockClass}>\n          <strong>Budget:</strong> {msg.budget}\n        </p>\n      )}\n\n      <p className=\"text-xs opacity-60\">\n        {new Date(msg.createdAt).toLocaleString()}\n      </p>\n    </section>\n  );\n}\n\n// === Main Page Component ===\n\nexport default function Messages() {\n  const [allMessages, setAllMessages] = useState<Message[]>([]);\n  const [filteredMessages, setFilteredMessages] = useState<Message[]>([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  const fetchMessages = useCallback(async (signal?: AbortSignal) => {\n    setLoading(true);\n    try {\n      const res = await fetch('/api/messages', { signal });\n      if (!res.ok) throw new Error('Failed to fetch messages');\n      const data = await res.json();\n\n      const sorted = data.messages.sort(\n        (a: Message, b: Message) =>\n          new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()\n      );\n\n      setAllMessages(sorted);\n      setFilteredMessages(sorted);\n    } catch (error) {\n      if (error instanceof Error && error.name !== 'AbortError') {\n        console.error('Error fetching messages:', error);\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    const abortController = new AbortController();\n    fetchMessages(abortController.signal);\n    return () => abortController.abort();\n  }, [fetchMessages]);\n\n  const handleDeleteMessage = async (messageId: string) => {\n    if (!confirm('Are you sure you want to delete this message?')) return;\n    try {\n      const res = await fetch(`/api/messages/${messageId}`, {\n        method: 'DELETE',\n      });\n      if (!res.ok) throw new Error('Failed to delete message');\n      setAllMessages((prev) => prev.filter((msg) => msg._id !== messageId));\n      setFilteredMessages((prev) =>\n        prev.filter((msg) => msg._id !== messageId)\n      );\n    } catch (error) {\n      console.error('Error deleting message:', error);\n    }\n  };\n\n  if (loading) return <p>Loading...</p>;\n\n  return (\n    <div className=\"grid gap-6 p-6 text-primary-900 dark:text-secondary-50\">\n      <h1 className=\"text-3xl font-bold\">Messages</h1>\n\n      <SearchInput\n        value={searchQuery}\n        onChange={setSearchQuery}\n        data={allMessages}\n        onFilter={setFilteredMessages}\n      />\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {filteredMessages.map((msg) => (\n          <MessageCard key={msg._id} msg={msg} onDelete={handleDeleteMessage} />\n        ))}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"wDAIA,EAAA,EAAA,CAAA,CAAA,OAqCA,IAAM,EAAU,CACd,SAAU,CAAC,EAAkB,KAC3B,GAAM,MAAE,CAAI,OAAE,CAAK,OAAE,CAAK,CAAE,CAAG,EAC/B,OACE,GAAM,cAAc,SAAS,IAC7B,GAAO,cAAc,SAAS,IAC9B,GAAO,KAAK,AAAC,GAAM,EAAE,WAAW,GAAG,QAAQ,CAAC,GAEhD,EACA,YAAa,CAAC,EAAkB,KAC9B,GAAM,CAAE,MAAI,aAAE,CAAW,MAAE,CAAI,CAAE,CAAG,EACpC,OACE,GAAM,cAAc,SAAS,IAC7B,GAAa,cAAc,SAAS,IACpC,GAAM,KAAK,AAAC,GAAM,EAAE,WAAW,GAAG,QAAQ,CAAC,GAE/C,EACA,YAAa,CAAC,EAAkB,KAC9B,GAAM,UAAE,CAAQ,WAAE,CAAS,SAAE,CAAO,QAAE,CAAM,CAAE,CAAG,EACjD,OACE,GAAU,cAAc,SAAS,IACjC,GAAW,cAAc,SAAS,IAClC,GAAS,cAAc,SAAS,IAChC,GAAQ,cAAc,SAAS,EAEnC,EACA,eAAgB,CAAC,EAAkB,KACjC,GAAM,CAAE,OAAK,UAAE,CAAQ,MAAE,CAAI,CAAE,CAAG,EAClC,OACE,GAAO,cAAc,SAAS,IAC9B,GAAU,cAAc,SAAS,IACjC,GAAM,KAAK,AAAC,GAAM,EAAE,WAAW,GAAG,QAAQ,CAAC,GAE/C,CACF,EAEe,SAAS,EAAkC,OACxD,CAAK,CACL,UAAQ,CACR,MAAI,UACJ,CAAQ,CACY,EACpB,IAAM,EAAW,CAAA,EAAA,EAAA,WAAW,AAAX,IAUjB,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,YAAY,YACZ,MAAO,EACP,SAAU,AAAC,IACT,UAAM,EAAQ,EAAE,MAAM,CAAC,KAAK,CAC5B,EAAS,GAdP,EAeS,AAfL,EAAM,WAAW,GAGrB,EAAW,CADX,EAAQ,AADK,OAAO,IAAI,CAAC,GACN,IAAI,CAAC,AAAC,GAAQ,EAAS,QAAQ,CAAC,KAChC,CAAO,CAAC,EAAM,CAAG,KAAM,EAChD,EAAS,EAAK,MAAM,CAAE,AAAD,GAAU,EAAS,EAAM,IAY5C,EACA,UAAU,qJAGhB,iECtGA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAkCA,SAAS,EAAY,KACnB,CAAG,UACH,CAAQ,CAIT,UAMC,MAAM,EAAiB,gDAEvB,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,CAAQ,UAAU,iTACjB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAW,CAAC,mBAAmB,EAAE,CAnCf,EAoChB,EAAI,MAAM,CApCsB,EAqChC,EAAI,MAAM,CAnClB,AAAI,CADE,EAAc,EAAO,WAAW,IACtB,QAAQ,CAAC,SAAiB,CAAP,YAC/B,EAAY,QAAQ,CAAC,QAAU,EAQ1B,CAPoC,CACzC,IAFuC,OAE3B,aACZ,YAAa,gBACb,YAAa,gBACb,YAAa,eACb,YAAa,cACf,CACiB,CAAC,EAAO,EAAI,uCAExB,gBAwBW,CACT,GAGL,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,4CAAoC,EAAI,MAAM,GAC5D,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAM,CAAA,CACL,QAAQ,QACR,KAAK,KACL,QArBc,AAAD,CAqBJ,GApBf,EAAE,eAAe,GACjB,EAAS,EAAI,GAAG,CAClB,EAmBQ,UAAU,uBACX,cAKH,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAW,YACZ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,UAAc,IAAE,EAAI,QAAQ,CAAC,KAAG,EAAI,SAAS,CAAC,OAGxD,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAW,YACZ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,aAAiB,IAAE,EAAI,OAAO,IAGvC,EAAI,OAAO,CAAC,UAAU,CAAC,SACtB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CACC,KAAM,EAAI,OAAO,CACjB,OAAO,SACP,IAAI,sBACJ,UAAU,8DACX,oBAKF,EAAI,MAAM,EACT,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAW,YACZ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,YAAgB,IAAE,EAAI,MAAM,IAIxC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,8BACV,IAAI,KAAK,EAAI,SAAS,EAAE,cAAc,OAI/C,CAIe,SAAS,IACtB,GAAM,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAY,EAAE,EACtD,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAY,EAAE,EAChE,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACzC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAEjC,EAAgB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,IACvC,GAAW,GACX,GAAI,CACF,IAAM,EAAM,MAAM,MAAM,gBAAiB,QAAE,CAAO,GAClD,GAAI,CAAC,EAAI,EAAE,CAAE,MAAM,AAAI,MAAM,4BAG7B,IAAM,EAAS,CAFF,MAAM,EAAI,IAAI,EAAA,EAEP,QAAQ,CAAC,IAAI,CAC/B,CAAC,EAAY,IACX,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO,GAAK,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO,IAGnE,EAAe,GACf,EAAoB,EACtB,CAAE,MAAO,EAAO,CACV,aAAiB,OAAwB,cAAc,CAA7B,EAAM,IAAI,EACtC,QAAQ,KAAK,CAAC,2BAA4B,EAE9C,QAAU,CACR,GAAW,EACb,CACF,EAAG,EAAE,EAEL,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAkB,IAAI,gBAE5B,OADA,EAAc,EAAgB,MAAM,EAC7B,IAAM,EAAgB,KAAK,EACpC,EAAG,CAAC,EAAc,EAElB,IAAM,EAAsB,MAAO,IACjC,GAAK,CAAD,OAAS,iDACb,CAD+D,EAC3D,CAIF,GAAI,CAAC,CAHO,MAAM,MAAM,CAAC,cAAc,EAAE,EAAA,CAAW,CAAE,CACpD,OAAQ,QACV,EAAA,EACS,EAAE,CAAE,MAAM,AAAI,MAAM,4BAC7B,EAAe,AAAC,GAAS,EAAK,MAAM,CAAC,AAAC,GAAQ,EAAI,GAAG,GAAK,IAC1D,EAAoB,AAAC,GACnB,EAAK,MAAM,CAAC,AAAC,GAAQ,EAAI,GAAG,GAAK,GAErC,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,0BAA2B,EAC3C,CACF,SAEA,AAAI,EAAgB,CAAA,EAAA,EAAA,EAAP,CAAO,EAAC,IAAA,UAAE,eAGrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mEACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,8BAAqB,aAEnC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAW,CAAA,CACV,MAAO,EACP,SAAU,EACV,KAAM,EACN,SAAU,IAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gEACZ,EAAiB,GAAG,CAAC,AAAC,GACrB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAA0B,IAAK,EAAK,SAAU,GAA7B,EAAI,GAAG,OAKnC"}
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,48002,e=>{"use strict";var a=e.i(43476),r=e.i(71645),s=e.i(17255),d=e.i(75254);let t=(0,d.default)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),i=(0,d.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var n=e.i(77957);function l({isOpen:e,onClose:s,user:d,onSave:t}){let[i,l]=(0,r.useState)({name:d.name,email:d.email,newPassword:"",currentPassword:"",error:"",loading:!1}),o=e=>{let{name:a,value:r}=e.target;l(e=>({...e,[a]:r}))},c=async e=>{e.preventDefault(),l(e=>({...e,loading:!0,error:""}));let a=await fetch(`/api/users/${d.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:i.name,email:i.email,password:i.newPassword||void 0,currentPassword:i.currentPassword})}),r=await a.json();a.ok?(t(),s()):l(e=>({...e,loading:!1,error:r.error||"Failed to update profile"}))};return e?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-secondary-900 rounded-lg p-6 w-full max-w-md shadow-lg border border-primary-200 dark:border-secondary-700",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Edit Profile"}),i.error&&(0,a.jsx)("p",{className:"text-red-600 dark:text-red-400 mb-2",children:i.error}),(0,a.jsxs)("form",{onSubmit:c,className:"grid gap-4",children:[(0,a.jsx)("input",{name:"name",value:i.name,onChange:o,placeholder:"Name",required:!0,className:"p-2 border rounded bg-primary-50 dark:bg-secondary-800 dark:border-secondary-700"}),(0,a.jsx)("input",{name:"email",value:i.email,onChange:o,placeholder:"Email",type:"email",required:!0,className:"p-2 border rounded bg-primary-50 dark:bg-secondary-800 dark:border-secondary-700"}),(0,a.jsx)("input",{name:"newPassword",value:i.newPassword,onChange:o,placeholder:"New Password",type:"password",className:"p-2 border rounded bg-primary-50 dark:bg-secondary-800 dark:border-secondary-700"}),(0,a.jsx)("input",{name:"currentPassword",value:i.currentPassword,onChange:o,placeholder:"Current Password",type:"password",required:!0,className:"p-2 border rounded bg-primary-50 dark:bg-secondary-800 dark:border-secondary-700"}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(n.default,{type:"button",onClick:s,variant:"ghost",size:"sm",children:"Cancel"}),(0,a.jsx)(n.default,{type:"submit",disabled:i.loading,variant:"secondary",size:"sm",children:i.loading?"Saving...":"Save"})]})]})]})}):null}let o=[{value:"under_3000",label:"Under $3,000"},{value:"3000_4500",label:"$3,000 - $4,500"},{value:"4500_6000",label:"$4,500 - $6,000"},{value:"6000_8000",label:"$6,000 - $8,000"},{value:"8000_plus",label:"$8,000+"}];function c({isOpen:e,onClose:s,message:d,onSave:t}){let[i,l]=(0,r.useState)({reason:"",budget:"",message:"",loading:!1,error:""});(0,r.useEffect)(()=>{d&&l({reason:d.reason||"",budget:d.budget||"",message:d.message,loading:!1,error:""})},[d]);let c=e=>{let{name:a,value:r}=e.target;l(e=>({...e,[a]:r}))},m=async e=>{(e.preventDefault(),i.message.trim())?(l(e=>({...e,loading:!0,error:""})),t({_id:d._id,reason:i.reason,budget:i.budget,message:i.message})):l(e=>({...e,error:"Message is required"}))};return e?(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-secondary-900 border border-primary-200 dark:border-secondary-700 rounded-lg p-6 w-full max-w-md shadow-lg",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Edit Message"}),i.error&&(0,a.jsx)("p",{className:"text-red-600 dark:text-red-400 mb-2",children:i.error}),(0,a.jsxs)("form",{onSubmit:m,className:"grid gap-4",children:[(0,a.jsx)("input",{name:"reason",value:i.reason,disabled:!0,className:"p-2 border rounded bg-gray-100 dark:bg-secondary-800 dark:border-secondary-700 text-gray-500 cursor-not-allowed"}),"job_offer"===i.reason&&(0,a.jsxs)("select",{name:"budget",value:i.budget,onChange:c,className:"p-2 border rounded bg-primary-50 dark:bg-secondary-800 dark:border-secondary-700",children:[(0,a.jsx)("option",{value:"",children:"Select budget"}),o.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]}),(0,a.jsx)("textarea",{name:"message",value:i.message,onChange:c,required:!0,placeholder:"Your message",className:"p-2 border rounded bg-primary-50 dark:bg-secondary-800 dark:border-secondary-700"}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(n.default,{type:"button",onClick:s,variant:"ghost",size:"sm",children:"Cancel"}),(0,a.jsx)(n.default,{type:"submit",disabled:i.loading,variant:"secondary",size:"sm",children:i.loading?"Saving...":"Save"})]})]})]})}):null}function m(){let{data:e,status:d}=(0,s.useSession)(),[o,m]=(0,r.useState)(!1),[g,p]=(0,r.useState)(!1),[h,x]=(0,r.useState)(null),[y,b]=(0,r.useState)(!1),[f,j]=(0,r.useState)([]),[v,w]=(0,r.useState)(!1);if((0,r.useEffect)(()=>{let a=async()=>{let e=await fetch("/api/messages");e.ok&&j((await e.json()).messages)};if("authenticated"===d&&e?.user?.roles){let r=Array.isArray(e.user.roles)&&e.user.roles.includes("admin");w(r),r||a()}},[d,e]),"loading"===d)return(0,a.jsx)("p",{className:"text-primary-900 dark:text-secondary-50",children:"Loading..."});if("authenticated"!==d||!e?.user)return(0,a.jsx)("p",{className:"text-primary-900 dark:text-secondary-50",children:"You need to log in to view this page."});let k=e.user.name??e.user.email??"User",N=e.user.email??"",S=async()=>{if(!confirm("Are you sure you want to permanently delete your account?"))return;b(!0);let a=await fetch(`/api/users/${e.user.id}`,{method:"DELETE"});b(!1),a.ok&&(0,s.signOut)()},C=async e=>{!confirm("Are you sure you want to delete this message?")||(await fetch(`/api/messages/${e}`,{method:"DELETE"})).ok&&j(a=>a.filter(a=>a._id!==e))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("section",{className:"grid gap-6 p-4 sm:p-6 w-full bg-white dark:bg-secondary-800 text-primary-900 dark:text-secondary-50 border border-primary-200 dark:border-secondary-700 rounded-md hover:shadow-md hover:ring-1 hover:ring-primary-300 dark:hover:ring-offset-2 hover:ring-offset-2 transition-shadow",children:[(0,a.jsxs)("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-[auto_1fr_auto] items-start",children:[(0,a.jsx)(u,{name:k}),(0,a.jsxs)("div",{className:"grid gap-1",children:[(0,a.jsx)("h2",{className:"text-lg font-bold tracking-tight",children:k}),(0,a.jsx)("p",{className:"text-sm opacity-80",children:N}),(0,a.jsxs)("p",{className:"text-sm",children:["Status:"," ",(0,a.jsx)("span",{className:e.user.isOnline?"text-green-600":"text-gray-500",children:e.user.isOnline?"Online":"Offline"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 text-sm sm:justify-end",children:[(0,a.jsxs)(n.default,{variant:"ghost",size:"sm",onClick:()=>m(!0),className:"inline-flex items-center gap-1",children:[(0,a.jsx)(t,{size:14})," Edit profile"]}),(0,a.jsxs)(n.default,{variant:"danger",size:"sm",onClick:S,disabled:y,className:"inline-flex items-center gap-1",children:[(0,a.jsx)(i,{size:14}),y?"Processing...":"Delete account"]})]})]}),(0,a.jsx)("p",{className:"text-sm opacity-80 tracking-wide leading-snug max-w-prose",children:"Welcome to your profile. Here you can view all the information stored in our database. You may edit your details or permanently delete your account, which will result in complete removal from our system."}),(0,a.jsx)(l,{isOpen:o,onClose:()=>m(!1),user:{id:e.user.id,name:k,email:N},onSave:()=>window.location.reload()})]}),!v&&f.length>0&&(0,a.jsxs)("section",{className:"grid gap-4 mt-6",children:[(0,a.jsx)("h3",{className:"text-md font-semibold",children:"Your Submitted Messages"}),(0,a.jsx)("ul",{className:"grid gap-4",children:f.map(e=>(0,a.jsxs)("li",{className:"grid gap-3 p-4 sm:p-6 w-full bg-white dark:bg-secondary-800 text-primary-900 dark:text-secondary-50 border border-primary-200 dark:border-secondary-700 rounded-md cursor-default hover:shadow-md hover:ring-1 hover:ring-primary-300 dark:hover:ring-offset-2 hover:ring-offset-2 transition-shadow",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_auto] items-start gap-2",children:[(0,a.jsx)("h4",{className:"text-lg font-bold tracking-tight",children:e.reason||"Message"}),(0,a.jsxs)("div",{className:"flex justify-start sm:justify-end gap-2 mt-2",children:[(0,a.jsx)(n.default,{size:"sm",variant:"ghost",onClick:()=>{x(e),p(!0)},children:(0,a.jsx)(t,{size:14})}),(0,a.jsx)(n.default,{size:"sm",variant:"danger",onClick:()=>C(e._id),children:(0,a.jsx)(i,{size:14})})]})]}),(0,a.jsx)("p",{className:"text-sm opacity-80 tracking-wide leading-snug max-w-prose",children:e.message}),e.budget&&(0,a.jsxs)("p",{className:"text-sm text-primary-700 dark:text-secondary-300",children:[(0,a.jsx)("strong",{children:"Budget:"})," ",e.budget]})]},e._id))})]}),h&&(0,a.jsx)(c,{isOpen:g,message:h,onClose:()=>p(!1),onSave:async e=>{let a=await fetch(`/api/messages/${e._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok){var r;r=(await a.json()).message,j(e=>e.map(e=>e._id===r._id?r:e)),p(!1),x(null)}}})]})}let u=(0,r.memo)(({name:e})=>(0,a.jsx)("div",{className:"w-10 h-10 grid place-items-center rounded-full bg-primary-900 text-white dark:bg-secondary-50 dark:text-secondary-900 font-bold text-sm shadow",children:e?e.charAt(0).toUpperCase():"?"}));u.displayName="ProfileAvatar",e.s(["default",()=>m],48002)}]);